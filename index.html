<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Petros Savvidis Resume</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(to right, #1e3c72, #2a5298);
            color: #333;
            overflow-x: hidden;
        }
        .container {
            max-width: 800px;
            margin: 50px auto;
            background: #fff;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
            animation: fadeIn 1s ease-in-out;
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            position: relative;
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
            animation: slideIn 1s ease-in-out;
        }
        h2 {
            text-align: left;
            color: #1e3c72;
            border-left: 4px solid #1e3c72;
            padding-left: 10px;
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        .section {
            margin: 30px 0;
            animation: fadeInUp 1.2s ease-in-out;
        }
        .section ul {
            list-style-type: none;
            padding: 0;
        }
        .section ul li {
            margin-bottom: 15px;
            padding: 15px;
            background: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, background 0.3s ease;
        }
        .section ul li:hover {
            transform: scale(1.03);
            background: #e9f4ff;
        }
        p {
            text-align: center;
            font-size: 1.2em;
            color: #555;
            margin-bottom: 20px;
        }
        .button-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }
        .btn {
            background-color: #2c3e50;
            color: white;
            border: none;
            padding: 10px;
            margin: 5px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.5em;
            transition: background-color 0.3s ease;
        }
        .btn:hover {
            background-color: #FFC107;
        }
        .btn i {
            font-size: 1.2em;
        }

        .profile-title {
            font-family: 'Poppins', sans-serif; /* or Poppins, Raleway, etc */
            font-size: 1.5em; /* slightly bigger */
            letter-spacing: 0.5px; /* optional: a bit wider spacing for style */
            color: #222; /* optional: a little darker if you want it to pop more */
        }

        .profile-picture-container {
            position: left;
            top: 20px;
            left: 20px;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            z-index: 1000;
        }

        .profile-picture {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .header {
            display: flex; /* Make children align horizontally */
            align-items: center; /* Vertically center-align items */
            justify-content: space-between;
            position: relative; /* To allow absolute positioning if needed */
            padding: 0 20px; /* Optional: Add padding for spacing */
        }

        .pdf-mode * {
            animation: none !important;
            transition: none !important;
            transform: none !important;
            filter: none !important;
            opacity: 1 !important;
            box-shadow: none !important;
            contain: none !important;
            will-change: auto !important;
        }

        .pdf-mode {
            background: white !important;
            color: black !important;
        }

        .flags {
            position: absolute;
            top: 2px; /* Place flags higher on the top-right corner */
            right: 20px; /* Align them to the right */
            display: flex;
            gap: 10px;
            font-size: 48px; /* Increase emoji size */
        }

        .flag {
            font-size: 40px; /* Ensure flags are large */
        }

        /* Initial styles for images */
        .project-image, .university-image {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer; /* Ensures the pointer cursor appears when hovering */
        }

        /* On hover, scale the image and add a shadow for emphasis */
        .project-image:hover, .university-image:hover {
            transform: scale(1.05); /* Slightly increase the size */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Add shadow for depth */
        }

        .work-title {
            display: flex;
            align-items: center;
        }

        .work-experience {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .location-badge {
            display: inline-flex;
            align-items: center;
            font-size: 14px;
            color: #777;
        }

        .location-badge span {
            font-size: 16px; /* Icon size */
            margin-right: 5px; /* Space between icon and location text */
        }

        /* Avoid breaking inside these elements */
        .avoid-break {
            page-break-inside: avoid;
            break-inside: avoid;
        }

        /* Force a page break before this element */
        .page-break {
            page-break-before: always;
            break-before: page;
        }

        /* Optional: Force after */
        .page-break-after {
            page-break-after: always;
            break-after: page;
        }

        #search-bar {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            position: sticky;
            top: 0;
            z-index: 9999;
            background-color: white; /* Optional: make sure the background is solid */
            padding: 10px; /* Adjust padding as needed */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .highlight {
            background-color: yellow;
            font-weight: bold;
        }

        /* Styling for the toggle button */
        .toggle-button {
            background-color: #2c3e50;
            border: 0px;
            color: white; /* Dark icon color for consistency */
            font-size: 1.5rem; /* Icon size */
            cursor: pointer;
            padding: 10px;
            margin: 5px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s ease, transform 0.3s ease; /* Smooth transition for hover effect */
        }

        /* Hover effect for the toggle button */
        .toggle-button:hover {
            background-color: #f1c40f; /* Match the exact yellow color for hover (adjusted) */
            color: #fff; /* Change icon color to white on hover */
            transform: scale(1.1); /* Slight enlarge effect on hover */
        }

        /* Focus effect for accessibility */
        .toggle-button:focus {
            outline: none;
            box-shadow: 0 0 0 2px rgba(241, 196, 15, 0.6); /* A subtle yellow outline matching the hover color */
        }

        .toggle-button.locked:hover {
            background-color: #f1c40f; /* Maintain yellow background when hover is locked */
            color: #fff; /* Icon color stays white */
        }

        #summary-instructions ul {
            list-style: none;
            padding-left: 0;
            border-left: 2px solid #ddd;
            margin-left: 1em;
        }

        #summary-instructions ul li {
            padding: 0.5em 0 0.5em 1em;
            position: relative;
        }

        #summary-instructions ul li::before {
            content: "";
            position: absolute;
            left: -0.6em;
            top: 1em;
            width: 0.5em;
            height: 0.5em;
            background-color: #3498db;
            border-radius: 50%;
        }

        .emoji {
            font-size: 1.5em; /* Makes emojis 1.5x bigger */
            vertical-align: middle; /* Keeps them aligned nicely with the text */
        }

        #phoneButton {
            font-size: 24px;
            cursor: pointer;
            position: relative;
            z-index: 10;
        }

        #overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            display: none; /* Initially hidden */
            justify-content: center;
            align-items: center;
            z-index: 5;
            flex-direction: column;
            text-align: center;
            color: white;
            font-size: 24px;
            transition: opacity 0.5s ease;
        }

        #circle {
            position: absolute;
            background-color: #3498db;
            border-radius: 50%;
            width: 0;
            height: 0;
            transition: all 1s ease-in-out;
            z-index: -1;
        }

        #message {
            opacity: 0;
            font-size: 30px;
            transition: opacity 1s ease;
        }

        /* Responsive design for smaller screens */
        @media (max-width: 600px) {
            .search-bar {
                width: 100%;
            }

            .button-container {
                flex-direction: column;
                align-items: flex-start;
            }

            .toggle-button {
                font-size: 1.2rem;
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.js"></script>
</head>
<body>

    <div class="search-container">
        <input type="text" id="search-bar" class="search-bar" placeholder="Simple Search in Projects..." oninput="searchResume()" />
    </div>

    <div class="container">

        <div class="flags">
            <span class="flag">🇬🇷</span> <!-- Greek flag -->
            <span class="flag">🇦🇺</span> <!-- Australian flag -->
        </div>

        <div class="header">

            <div class="profile-picture-container">
                <img src="https://raw.githubusercontent.com/psavidis/resume/refs/heads/master/assets/profile_picture.jpeg" alt="Profile Picture" class="profile-picture">
            </div>

            <h1 id="name">Your Name</h1>

        </div>

        <div>
            <p id="summary" class="profile-title"></p>
            <p id="summary-intro">Welcome to my Dynamic | Git-powered | Code-driven Resume! <span class="emoji">🤘</span></p>
            <div id="summary-instructions">
                <ul>
                    <li>Feel free to <b>Connect</b> with me via email, LinkedIn, or phone to explore potential business opportunities</li>
                    <li><b>Download</b> my resume in PDF format</li>
                    <li><b>Search</b> through my projects using simple keywords</li>
                </ul>
            </div>
            <p id="summary-free">Outside of work, I’m passionate about traveling, making music, diving into philosophy, and swimming <span class="emoji">✈️🎵📖🏊‍ </span> ️</p>
        </div>

        <div class="section" id="experience">
            <h2 id="experienceTitle">Experience</h2>
            <ul id="experience-list"></ul>
        </div>

        <div class="section page-break" id="Projects">
            <h2>Projects</h2>
            <ul id="projects-list"></ul>
        </div>

        <div class="section" id="education">
            <h2>Education</h2>
            <ul id="education-list"></ul>
        </div>
    </div>

    <div class="button-container">
        <button class="btn" onclick="window.location.href='mailto:peter.savidis1@gmail.com'"><i class="fas fa-envelope"></i></button>
        <button id="phoneButton" class="btn"><i class="fas fa-phone-alt"></i></button>
        <div id="overlay">
            <div id="circle"></div>
            <div id="message">Would you like to have a chat? Feel free to send me an email, and we can schedule a convenient time for a phone call. Looking forward to connecting!</div>
        </div>
        <button class="btn" onclick="window.open('https://www.google.com.au/maps/place/Melbourne+VIC/@-37.9648869,143.8048508,9z/data=!3m1!4b1!4m6!3m5!1s0x6ad646b5d2ba4df7:0x4045675218ccd90!8m2!3d-37.8136276!4d144.9630576!16zL20vMGNoZ3pt?entry=ttu&g_ep=EgoyMDI1MDQwMS4wIKXMDSoASAFQAw%3D%3D', '_blank')"><i class="fas fa-map-marker-alt"></i></button>
        <button class="btn" onclick="window.location.href='https://www.linkedin.com/in/petros-savvidis-8994b857/'"><i class="fab fa-linkedin-in"></i></button>
        <button class="btn" id="pdf-btn"><i class="fas fa-file-pdf"></i></button>
        <button class="toggle-button" id="toggle-search"><i class="fas fa-search"></i></button>
    </div>

    <script>
        async function loadResumeData() {
            try {
                const response = await fetch('https://raw.githubusercontent.com/psavidis/resume/refs/heads/master/assets/data.json');
                if (!response.ok) throw new Error('Failed to fetch data');

                const data = await response.json();

                populateHeader(data);
                populateWorkExperience(data);
                populateProjects(data);
                populateEducation(data);

            } catch (error) {
                console.error('Error loading resume data:', error);
            }
        }

        function populateHeader(data) {
            document.getElementById('name').textContent = data.name || 'Name not provided';

            let fontSize = '13px';

            let summary = document.getElementById('summary');
            summary.textContent = data.summary || 'Summary not provided';
            summary.style.textAlign = 'left';
            summary.style.fontSize = fontSize;

            let summaryIntro = document.getElementById('summary-intro');
            summaryIntro.style.textAlign = 'left';
            summaryIntro.style.fontSize = fontSize;

            let summaryFree = document.getElementById('summary-free');
            summaryFree.style.textAlign = 'left';
            summaryFree.style.fontSize = fontSize;

            let summaryInstructions = document.getElementById('summary-instructions');
            summaryInstructions.style.textAlign = 'left';
            summaryInstructions.style.fontSize = fontSize;
        }

        function populateWorkExperience(data) {
            const experienceList = document.getElementById('experience-list');
            experienceList.innerHTML = '';

            if (!Array.isArray(data.workExperience)) {
                experienceList.innerHTML = '<li>No experience data available</li>';
                return;
            }

            data.workExperience = sortByField(data.workExperience, 'startDate', 'asc');

            data.workExperience.forEach(item => {
                const li = document.createElement('li');
                li.classList.add('work-experience');

                const workTitleAndImg = document.createElement('div');
                workTitleAndImg.classList.add('work-title');

                // Create company logo image
                const companyImg = createCompanyImg(item);

                // Create text span for job details
                const textSpan = document.createElement('span');
                textSpan.textContent = `${item.title || 'Position not provided'} at ${item.company || 'Company not provided'} (${item.startDate || ''} - ${item.endDate || 'Present'})`;

                workTitleAndImg.appendChild(companyImg);
                workTitleAndImg.appendChild(textSpan);

                const div = document.createElement('div');
                div.classList.add('location-badge');

                const span = document.createElement('span');
                div.appendChild(span);
                div.textContent = '📍' + item.location;

                // Append logo and text
                li.appendChild(workTitleAndImg);
                li.appendChild(div);

                experienceList.appendChild(li);
            });

            const totalXP = getTotalExperience(data.workExperience);
            const formattedXP = formatTotalExperienceIntoYears(totalXP);

            document.getElementById('experienceTitle').textContent = 'Experience (' + formattedXP + ')';
        }

        function formatTotalExperienceIntoYears(totalExperience) {
            const years = totalExperience.years;
            const months = totalExperience.months;

            // Format the output
            if (months > 0) {
                return `${years}+ years`; // If there are months, show a +
            } else {
                return `${years} years`; // If no months, show only years with a "+"
            }
        }

        function populateProjects(data) {
            const projectsList = document.getElementById('projects-list');
            projectsList.innerHTML = '';

            if (!Array.isArray(data.project)) {
                projectsList.innerHTML = '<li>No projects data available</li>';
                return;
            }

            data.project = sortByField(data.project, 'startDate', 'desc');

            data.project.forEach(project => {
                const li = document.createElement('li');

                li.classList.add('project-li');
                li.style.cursor = 'pointer';
                li.style.padding = '12px';
                li.style.border = '1px solid #ccc';
                li.style.borderRadius = '8px';
                li.style.marginBottom = '8px';
                li.style.backgroundColor = '#f9f9f9';
                li.style.transition = 'background-color 0.2s ease-in-out';

                li.addEventListener('mouseenter', () => {
                    li.style.backgroundColor = '#e3eafc';
                });
                li.addEventListener('mouseleave', () => {
                    li.style.backgroundColor = '#f9f9f9';
                });

                // Project name
                const projectName = document.createElement('span');
                projectName.textContent = project.name || 'Project not provided';
                projectName.style.color = '#1e3c72';
                projectName.style.fontSize = '18px';
                projectName.style.fontWeight = 'bold';

                // Description
                const projectDescription = document.createElement('p');
                projectDescription.classList.add('project-description');
                projectDescription.textContent = project.description || 'No description provided';
                projectDescription.style.display = 'none';
                projectDescription.style.fontSize = '14px';
                projectDescription.style.color = '#444';
                projectDescription.style.marginTop = '10px';
                projectDescription.style.textAlign = 'left';

                // Tools Used
                const techUsed = document.createElement('p');
                techUsed.classList.add('project-tech');
                techUsed.textContent = project.techUsed ? `Tools: ${project.techUsed.join(', ')}` : '';
                techUsed.style.display = 'none';
                techUsed.style.fontSize = '13px';
                techUsed.style.fontStyle = 'italic';
                techUsed.style.color = '#666';
                techUsed.style.marginTop = '5px';
                techUsed.style.textAlign = 'left';

                // Points (bullet list)
                const pointsList = document.createElement('ul');

                pointsList.classList.add('project-points');
                pointsList.style.display = 'none';
                pointsList.style.paddingLeft = '20px';
                pointsList.style.listStyleType = 'disc';
                pointsList.style.marginTop = '5px';
                pointsList.style.fontSize = '13px';

                if (project.points && Array.isArray(project.points)) {
                    project.points.forEach(point => {
                        const pointItem = document.createElement('li');
                        pointItem.textContent = point.toString();
                        pointItem.style.marginBottom = '3px';
                        pointItem.style.listStyleType = 'circle';
                        pointItem.style.background = 'none';
                        pointItem.style.padding = '2px 0';
                        pointItem.style.backgroundColor = 'transparent';
                        pointItem.style.border = 'none';
                        pointItem.style.boxShadow = 'none';
                        pointsList.appendChild(pointItem);
                    });
                }

                const showProjectButtons = createShowProjectButtons(project);

                const hasProjectButtons = showProjectButtons.length > 0;

                // Toggle description/tech/points on click
                li.addEventListener('click', () => {
                    const isVisible = projectDescription.style.display === 'block';
                    projectDescription.style.display = isVisible ? 'none' : 'block';
                    pointsList.style.display = isVisible ? 'none' : 'block';
                    techUsed.style.display = isVisible ? 'none' : 'block';

                    if (hasProjectButtons) {
                        showProjectButtons.forEach(button => {
                            button.style.display = isVisible ? 'none' : 'inline-block';
                        });
                    }
                });

                li.appendChild(projectName);
                li.appendChild(projectDescription);
                li.appendChild(pointsList);
                li.appendChild(document.createElement('br'));

                let hasTechUsed = techUsed && techUsed.textContent.trim() !== "Tools:";

                if (hasTechUsed) {
                    li.appendChild(techUsed);
                }

                if (hasProjectButtons) {
                    showProjectButtons.forEach(button => {
                        li.appendChild(button);
                    });
                }

                projectsList.appendChild(li);
            });
        }

        function createCompanyImg(item) {
            const img = document.createElement('img');

            img.src = item.companyLogo;
            img.classList.add('project-image');
            img.style.width = '40px';
            img.style.height = '40px';
            img.style.borderRadius = '50%';
            img.style.marginRight = '10px';
            img.style.verticalAlign = 'middle';

            const link = document.createElement('a');
            link.href = item.companyLink || '#'; // Default to "#" if no URL provided

            link.appendChild(img);

            return link;
        }

        function createSchoolImg(item) {
            const img = document.createElement('img');

            img.src = item.schoolLogo;
            img.classList.add('university-image');
            img.style.width = '40px';
            img.style.height = '40px';
            img.style.borderRadius = '50%';
            img.style.marginRight = '10px';
            img.style.verticalAlign = 'middle';

            const link = document.createElement('a');
            link.href = item.schoolLink || '#'; // Default to "#" if no URL provided

            link.appendChild(img);

            return link;
        }

        function createShowProjectButtons(project) {
            const projectLinks = project.links;

            if (!Array.isArray(projectLinks)) {
                return []; // No references to show
            }

            let result = [];

            projectLinks.forEach(link => {
                const showProjectButton = document.createElement('a');

                showProjectButton.classList.add('project-button');
                showProjectButton.textContent = 'Show Project';
                showProjectButton.href = link || '#'; // Default to "#" if no URL provided
                showProjectButton.target = '_blank'; // Open in new tab
                showProjectButton.style.display = 'none';
                showProjectButton.style.marginTop = '10px';
                showProjectButton.style.marginRight = '10px'; // Add margin between buttons
                showProjectButton.style.padding = '8px 12px';
                showProjectButton.style.background = '#007BFF';
                showProjectButton.style.color = 'white';
                showProjectButton.style.textDecoration = 'none';
                showProjectButton.style.borderRadius = '5px';
                showProjectButton.style.fontSize = '11px';
                showProjectButton.style.fontWeight = 'bold';
                showProjectButton.style.textAlign = 'center';
                showProjectButton.style.width = 'fit-content';
                showProjectButton.style.transition = 'background 0.3s';

                // Button hover effect
                showProjectButton.addEventListener('mouseover', () => {
                    showProjectButton.style.background = '#0056b3';
                });
                showProjectButton.addEventListener('mouseout', () => {
                    showProjectButton.style.background = '#007BFF';
                });

                result.push(showProjectButton);
            });

            return result;
        }

        function populateEducation(data) {
            const educationList = document.getElementById('education-list');

            if (!Array.isArray(data.education)) {
                educationList.innerHTML = '<li>No education data available</li>';
                return;
            }

            data.education.forEach(item => {
                const li = document.createElement('li');

                const textSpan = document.createElement('span');
                textSpan.textContent = `${item.school || 'Institution not provided'}, ${item.degree || 'Field of study not provided'} (${item.startYear || ''} - ${item.endYear || 'Present'})`;

                const schoolImg = createSchoolImg(item);

                li.appendChild(schoolImg);
                li.appendChild(textSpan);

                educationList.appendChild(li);
            });
        }

        function downloadPage() {
            const resume = document.querySelector('.container');

            if (!resume) {
                console.error("Resume container not found!");
                return;
            }

            // Add class to disable transforms, animations, etc.
            resume.classList.add('pdf-mode');

            const projectItems = document.querySelectorAll('.project-li');

            customizePageBreaks(projectItems);

            const techUsed = document.querySelectorAll('.project-tech');
            const projectDescriptions = document.querySelectorAll('.project-description');
            const projectPoints = document.querySelectorAll('.project-points');
            const projectButtons = document.querySelectorAll('.project-button');

            makeVisible(projectItems);
            makeVisible(techUsed);
            makeVisible(projectDescriptions);
            makeVisible(projectPoints);
            makeVisible(projectButtons);

            // Give the browser time to apply styles
            setTimeout(() => {
                html2pdf()
                    .set({
                        margin: 0,
                        filename: 'resume.pdf',
                        pagebreak: {
                            mode: ['css', 'legacy']  // must include 'css' so page-break styles are respected
                            // after: '.page-break'
                        },
                        image: { type: 'jpeg', quality: 0.98 },
                        html2canvas: {
                            scale: 2,
                            useCORS: true,
                            logging: true,
                            backgroundColor: '#ffffff',
                            scrollY: 0
                        },
                        jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
                    })
                    .from(resume)
                    .save()
                    .then(() => {
                        // resume.classList.remove('pdf-mode');
                        location.reload();
                    })
                    .catch(err => {
                        console.error("PDF generation failed:", err);
                        resume.classList.remove('pdf-mode');
                    });
            }, 300); // give time for the style to apply
        }

        // Function to parse and compare dates
        function sortByField(data, field, order = 'desc') {
            return data.sort((a, b) => {
                // Extract the date components (e.g., "MM-YYYY")
                const [monthA, yearA] = a[field].split('-');
                const [monthB, yearB] = b[field].split('-');

                // Create Date objects from the extracted month and year
                const dateA = new Date(yearA, monthA - 1);  // monthA - 1 because months are 0-indexed
                const dateB = new Date(yearB, monthB - 1);  // monthB - 1 for the same reason

                // Return based on the order: ascending or descending
                if (order === 'asc') {
                    return dateA - dateB; // ascending order
                } else {
                    return dateB - dateA; // descending order
                }
            });
        }

        function calculateExperience(startDate, endDate) {
            const start = parseMonthYearString(startDate);
            const end = (endDate === 'Present') ? new Date() : new parseMonthYearString(endDate);  // Handle 'Present' as current date

            return (end.getFullYear() - start.getFullYear()) * 12 + (end.getMonth() - start.getMonth());
        }

        // Function to calculate the total experience
        function getTotalExperience(workExperience) {
            let totalExperienceMonths = 0;

            workExperience.forEach(job => {

                if (job.company === 'Hellenic Army') {
                    return;
                }

                totalExperienceMonths += calculateExperience(job.startDate, job.endDate);
            });

            // Convert the total experience to years and months
            const years = Math.floor(totalExperienceMonths / 12);
            const months = totalExperienceMonths % 12;

            return { years, months };
        }

        function parseMonthYearString(monthYearString) {
            const [monthName, yearString] = monthYearString.split(' ');
            const year = parseInt(yearString, 10);

            const monthNames = [
                "January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December"
            ];

            const monthIndex = monthNames.indexOf(monthName);

            if (monthIndex === -1 || isNaN(year)) {
                throw new Error(`Invalid date string: ${monthYearString}`);
            }

            return new Date(Date.UTC(year, monthIndex, 1)); // Always safe
        }

        function makeVisible(elements) {
            elements.forEach(item => {
                // Directly manipulate the height and visibility to ensure they expand
                item.style.height = 'auto';  // Ensure the items expand to their full height
                item.style.display = 'block';  // Make sure the item is displayed (not hidden)
                item.style.overflow = 'visible';  // Ensure the content is visible
                item.style.transition = 'none';  // Disable any transitions that could cause issues
            });
        }

        // Customize this function with page breaks per project if they don't fit HERE
        function customizePageBreaks(projectItems) {
            projectItems[3].style.marginTop = '15mm';
            projectItems[6].style.marginTop = '35mm'; // Eleura
        }

        function searchResume() {
            let input = document.getElementById('search-bar').value.toLowerCase();
            let sections = document.querySelectorAll('#Projects'); // Assuming sections are in the 'container' class

            // Add a class to disable animations during search
            document.body.classList.add('searching');

            sections.forEach(section => {
                // Reset previous highlights and ensure animation is not triggered
                removeHighlights(section);

                // Only proceed if there is search input
                if (input === '') {
                    section.style.display = 'block'; // Show the section if search input is empty
                    return;
                }

                let textContent = section.textContent || section.innerText;
                if (textContent.toLowerCase().includes(input)) {
                    // section.style.display = 'block'; // Show the section if it contains the search term
                    highlightText(section, input); // Highlight the matching text
                } else {
                    // section.style.display = 'none'; // Hide the section if it does not contain the search term
                }
            });

            // Remove the class to re-enable animations after a short delay
            setTimeout(() => {
                document.body.classList.remove('searching');
            }, 1000); // Timeout to allow changes to take place before animations are re-enabled
        }

        function highlightText(section, input) {
            const words = input.split(/\s+/); // Split the input into multiple words separated by spaces
            words.forEach(word => {
                const escapedWord = escapeRegExp(word); // Escape the word for safe regex use
                const regex = new RegExp(`\\b(${escapedWord})\\b`, 'gi'); // Case-insensitive matching for whole words
                const nodes = getTextNodes(section);

                nodes.forEach(node => {
                    const text = node.nodeValue;
                    const parts = text.replace(regex, (match) => {
                        // Wrap matched words in a span
                        return `<span class="highlight">${match}</span>`;
                    });

                    if (parts !== text) { // Only replace if something was highlighted
                        const fragment = document.createDocumentFragment();
                        const tempDiv = document.createElement('div');
                        tempDiv.innerHTML = parts; // Use innerHTML to insert the replaced content
                        while (tempDiv.firstChild) {
                            fragment.appendChild(tempDiv.firstChild); // Append all child nodes (including the span)
                        }
                        node.replaceWith(fragment); // Replace original node with the new fragment
                    }
                });
            });
        }

        // Function to remove previous highlights
        function removeHighlights(section) {
            const highlightedText = section.querySelectorAll('.highlight');
            highlightedText.forEach(span => {
                const parentNode = span.parentNode;
                parentNode.replaceChild(document.createTextNode(span.innerText), span); // Replace span with plain text
            });
        }

        // Function to get all text nodes within a section
        function getTextNodes(element) {
            let textNodes = [];
            for (let node of element.childNodes) {
                if (node.nodeType === 3) { // Text node
                    textNodes.push(node);
                } else if (node.nodeType === 1) { // Element node, recurse into child elements
                    textNodes = textNodes.concat(getTextNodes(node));
                }
            }
            return textNodes;
        }

        // Function to escape special characters for regex
        function escapeRegExp(string) {
            return string.replace(/[.*+?^=!:${}()|\[\]\/\\]/g, '\\$&');
        }

        function hideSearchBar() {
            const searchBar = document.getElementById('search-bar');
            searchBar.style.display = 'none';
        }

        function makeHidden(elements) {
            elements.forEach(item => {
                item.style.display = 'none';  // Make sure the item is displayed (not hidden)
            });
        }

        function initializeSearchToggle() {
            const searchToggle = document.getElementById('toggle-search');
            searchToggle.addEventListener('click', function() {
                const searchBar = document.getElementById('search-bar');

                if (searchBar.style.display === 'block') {
                    searchBar.style.display = 'none';

                    hideProjects();

                    // init search bar and remove highlights
                    if (searchBar) {
                        searchBar.value = '';
                        searchResume();
                    }

                } else {
                    showProjects();

                    searchBar.style.display = 'block';
                }
            });
        }

        function showProjects() {
            const projectItems = document.querySelectorAll('.project-li');

            const techUsed = document.querySelectorAll('.project-tech');
            const projectDescriptions = document.querySelectorAll('.project-description');
            const projectPoints = document.querySelectorAll('.project-points');
            const projectButtons = document.querySelectorAll('.project-button');

            makeVisible(projectItems);
            makeVisible(techUsed);
            makeVisible(projectDescriptions);
            makeVisible(projectPoints);
            makeVisible(projectButtons);
        }

        function hideProjects() {

            const techUsed = document.querySelectorAll('.project-tech');
            const projectDescriptions = document.querySelectorAll('.project-description');
            const projectPoints = document.querySelectorAll('.project-points');
            const projectButtons = document.querySelectorAll('.project-button');

            makeHidden(techUsed);
            makeHidden(projectDescriptions);
            makeHidden(projectPoints);
            makeHidden(projectButtons);
        }

        function initializePdfButton() {
            document.getElementById('pdf-btn').addEventListener('click', downloadPage);
        }

        function configureSearchBarPositioning() {
            window.addEventListener('scroll', function() {
                const searchBar = document.querySelector('#search-bar');
                const bottomOfPage = document.documentElement.scrollHeight - window.innerHeight;

                // Check if the page is near the bottom
                if (window.scrollY >= bottomOfPage - searchBar.offsetHeight) {
                    searchBar.style.position = 'fixed'; // Keep it fixed at the bottom
                    searchBar.style.top = 'auto'; // Remove the top property
                    searchBar.style.bottom = '0'; // Fix it at the bottom of the page
                } else {
                    searchBar.style.position = 'sticky';
                    searchBar.style.top = '0'; // Keep it at the top
                    searchBar.style.bottom = ''; // Reset the bottom property
                }
            });
        }

        function configurePhoneButton() {
            const phoneButton = document.getElementById('phoneButton');
            const overlay = document.getElementById('overlay');
            const circle = document.getElementById('circle');
            const message = document.getElementById('message');

            phoneButton.addEventListener('click', () => {
                // Show the overlay
                overlay.style.display = 'flex';

                // Position the circle over the button and animate it
                const buttonRect = phoneButton.getBoundingClientRect();
                const circleSize = Math.max(window.innerWidth, window.innerHeight);

                // Start the circle animation
                circle.style.left = `${buttonRect.left + buttonRect.width / 2 - circleSize / 2}px`;
                circle.style.top = `${buttonRect.top + buttonRect.height / 2 - circleSize / 2}px`;
                circle.style.width = `${circleSize}px`;
                circle.style.height = `${circleSize}px`;

                // Show the message after the circle animation ends
                setTimeout(() => {
                    message.style.opacity = 1;
                }, 1000); // Delay the text appearance until after the circle animation

                setTimeout(() => {
                    message.style.opacity = 0;
                    circle.style.width = '0';
                    circle.style.height = '0';
                }, 8000);

                // Reset everything and hide the overlay after 6 seconds
                setTimeout(() => {
                    overlay.style.display = 'none'; // Hide overlay
                    circle.style.left = '0'; // Reset circle position
                    circle.style.top = '0'; // Reset circle position
                    circle.style.width = '0'; // Reset circle size
                    circle.style.height = '0'; // Reset circle size
                }, 9000); // Hide overlay and reset circle after the entire animation completes
            });
        }

        function showEasterEgg() {
            console.log('🐇🐰🥚If you see this little easter egg, you are a either developer or a curious recruiter with dev skills! Keep up the good work! 🎉');
        }

        loadResumeData();

        initializePdfButton();
        hideSearchBar();

        initializeSearchToggle();
        configureSearchBarPositioning();
        configurePhoneButton()
        showEasterEgg();
    </script>
</body>
</html>
