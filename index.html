<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Petros Savvidis Resume</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(to right, #1e3c72, #2a5298);
            color: #333;
            overflow-x: hidden;
        }
        .container {
            max-width: 800px;
            margin: 50px auto;
            background: #fff;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
            animation: fadeIn 1s ease-in-out;
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
            animation: slideIn 1s ease-in-out;
        }
        h2 {
            text-align: left;
            color: #1e3c72;
            border-left: 4px solid #1e3c72;
            padding-left: 10px;
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        .section {
            margin: 30px 0;
            animation: fadeInUp 1.2s ease-in-out;
        }
        .section ul {
            list-style-type: none;
            padding: 0;
        }
        .section ul li {
            margin-bottom: 15px;
            padding: 15px;
            background: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, background 0.3s ease;
        }
        .section ul li:hover {
            transform: scale(1.03);
            background: #e9f4ff;
        }
        p {
            text-align: center;
            font-size: 1.2em;
            color: #555;
            margin-bottom: 20px;
        }
        .button-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }
        .btn {
            background-color: #2c3e50;
            color: white;
            border: none;
            padding: 10px;
            margin: 5px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.5em;
            transition: background-color 0.3s ease;
        }
        .btn:hover {
            background-color: #FFC107;
        }
        .btn i {
            font-size: 1.2em;
        }

        .profile-picture-container {
            position: left;
            top: 20px;
            left: 20px;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            z-index: 1000;
        }

        .profile-picture {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .header {
            display: flex; /* Make children align horizontally */
            align-items: center; /* Vertically center-align items */
            justify-content: space-between;
            position: relative; /* To allow absolute positioning if needed */
            padding: 0 20px; /* Optional: Add padding for spacing */
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.js"></script>
</head>
<body>
    <div class="container">

        <div class="header">

            <div class="profile-picture-container">
                <img src="https://raw.githubusercontent.com/psavidis/resume/refs/heads/master/assets/profile_picture.jpeg" alt="Profile Picture" class="profile-picture">
            </div>

            <h1 id="name">Your Name</h1>

        </div>

        <p id="summary">Your professional summary goes here...</p>

        <div class="section" id="experience">
            <h2>Experience</h2>
            <ul id="experience-list"></ul>
        </div>

        <div class="section" id="Projects">
            <h2>Projects</h2>
            <ul id="projects-list"></ul>
        </div>

        <div class="section" id="education">
            <h2>Education</h2>
            <ul id="education-list"></ul>
        </div>
    </div>

    <div class="button-container">
        <button class="btn" onclick="window.location.href='https://www.linkedin.com/in/petros-savvidis-8994b857/'"><i class="fab fa-linkedin-in"></i></button>
        <button class="btn" onclick="window.location.href='https://www.facebook.com'"><i class="fab fa-facebook-f"></i></button>
        <button class="btn" onclick="window.location.href='mailto:peter.savidis1@gmail.com'"><i class="fas fa-envelope"></i></button>
        <!-- <button class="btn" onclick="window.location.href='tel:+1234567890'"><i class="fas fa-phone-alt"></i></button> -->
        <button class="btn" id="pdf-btn" onclick="downloadPDF()"><i class="fas fa-file-pdf"></i></button> <!-- PDF Button -->
    </div>

    <script>
        async function loadResumeData() {
            try {
                const response = await fetch('https://raw.githubusercontent.com/psavidis/resume/refs/heads/master/assets/data.json');
                if (!response.ok) throw new Error('Failed to fetch data');

                const data = await response.json();

                populateHeader(data);
                populateWorkExperience(data);
                populateProjects(data);
                populateEducation(data);

            } catch (error) {
                console.error('Error loading resume data:', error);
            }
        }

        function populateHeader(data) {
            document.getElementById('name').textContent = data.name || 'Name not provided';
            document.getElementById('summary').textContent = data.summary || 'Summary not provided';
        }

        function populateWorkExperience(data) {
            const experienceList = document.getElementById('experience-list');
            experienceList.innerHTML = '';

            if (!Array.isArray(data.workExperience)) {
                experienceList.innerHTML = '<li>No experience data available</li>';
                return;
            }

            data.workExperience = sortByField(data.workExperience, 'startDate', 'asc');

            data.workExperience.forEach(item => {
                const li = document.createElement('li');

                // Create company logo image
                const logo = document.createElement('img');
                logo.src = item.companyLogo || 'default-logo.png'; // Fallback image
                logo.alt = `${item.company} Logo`;
                logo.style.width = '40px';
                logo.style.height = '40px';
                logo.style.borderRadius = '50%';
                logo.style.marginRight = '10px';
                logo.style.verticalAlign = 'middle';

                // Create text span for job details
                const textSpan = document.createElement('span');
                textSpan.textContent = `${item.title || 'Position not provided'} at ${item.company || 'Company not provided'} (${item.startDate || ''} - ${item.endDate || 'Present'})`;

                // Append logo and text
                li.appendChild(logo);
                li.appendChild(textSpan);
                experienceList.appendChild(li);
            });
        }

        function populateProjects(data) {
            const projectsList = document.getElementById('projects-list');
            projectsList.innerHTML = '';

            if (!Array.isArray(data.project)) {
                projectsList.innerHTML = '<li>No projects data available</li>';
                return;
            }

            data.project = sortByField(data.project, 'startDate', 'desc');

            data.project.forEach(project => {
                const li = document.createElement('li');

                li.style.cursor = 'pointer'; // Make it clear that the whole item is clickable
                li.style.padding = '12px';
                li.style.border = '1px solid #ccc';
                li.style.borderRadius = '8px'; // Rounded corners for a modern look
                li.style.marginBottom = '8px';
                li.style.backgroundColor = '#f9f9f9'; // Light background
                li.style.transition = 'background-color 0.2s ease-in-out';

                // Hover effect
                li.addEventListener('mouseenter', () => {
                    li.style.backgroundColor = '#e3eafc';
                });
                li.addEventListener('mouseleave', () => {
                    li.style.backgroundColor = '#f9f9f9';
                });

                const projectName = document.createElement('span');
                projectName.textContent = project.name || 'Project not provided';
                projectName.style.color = '#1e3c72';
                projectName.style.fontSize = '18px'; // Make the title larger
                projectName.style.fontWeight = 'bold'; // Make it stand out

                // Create the project description, initially hidden
                const projectDescription = document.createElement('p');
                projectDescription.textContent = project.description || 'No description provided';
                projectDescription.style.display = 'none';
                projectDescription.style.fontSize = '14px'; // Smaller than title
                projectDescription.style.color = '#444';
                projectDescription.style.marginTop = '10px';
                projectDescription.style.textAlign = 'left';

                // Create the list for project points
                const pointsList = document.createElement('ul');
                pointsList.style.display = 'none';
                pointsList.style.paddingLeft = '20px';
                pointsList.style.listStyleType = 'disc';  // Ensure it uses bullet points
                pointsList.style.marginTop = '5px';
                pointsList.style.fontSize = '13px';  // Slightly smaller text

                // Add points to the list
                if (project.points && Array.isArray(project.points)) {
                    project.points.forEach(point => {
                        const pointItem = document.createElement('li');
                        pointItem.textContent = point.toString();
                        pointItem.style.marginBottom = '3px';
                        pointItem.style.listStyleType = 'circle';
                        pointItem.style.background = 'none';  // Ensure no button-like styling
                        pointItem.style.padding = '2px 0';
                        pointItem.style.border = 'none'; // Remove any borders

                        pointsList.appendChild(pointItem);
                    });
                }

                const showProjectButtons = createShowProjectButtons(project);

                const hasProjectButtons = showProjectButtons.length > 0;

                // Add click event to toggle description visibility (on the entire <li>)
                li.addEventListener('click', () => {
                    const isHidden = projectDescription.style.display === 'none';

                    projectDescription.style.display = isHidden ? 'block' : 'none';
                    pointsList.style.display = isHidden ? 'block' : 'none';

                    if (hasProjectButtons) {
                        showProjectButtons.forEach(button => {
                            button.style.display = isHidden ? 'inline-block' : 'none';
                        });
                    }
                });

                // Append the name and description to the list item
                li.appendChild(projectName);
                li.appendChild(projectDescription);
                li.appendChild(pointsList);

                if (hasProjectButtons) {
                    showProjectButtons.forEach(button => {
                        li.appendChild(button);
                    });
                }

                projectsList.appendChild(li);

            });
        }

        function createShowProjectButtons(project) {
            const projectLinks = project.links;

            if (!Array.isArray(projectLinks)) {
                return []; // No references to show
            }

            let result = [];

            projectLinks.forEach(link => {
                const showProjectButton = document.createElement('a');

                showProjectButton.textContent = 'Show Project';
                showProjectButton.href = link || '#'; // Default to "#" if no URL provided
                showProjectButton.target = '_blank'; // Open in new tab
                showProjectButton.style.display = 'none';
                showProjectButton.style.marginTop = '10px';
                showProjectButton.style.marginRight = '10px'; // Add margin between buttons
                showProjectButton.style.padding = '8px 12px';
                showProjectButton.style.background = '#007BFF';
                showProjectButton.style.color = 'white';
                showProjectButton.style.textDecoration = 'none';
                showProjectButton.style.borderRadius = '5px';
                showProjectButton.style.fontSize = '11px';
                showProjectButton.style.fontWeight = 'bold';
                showProjectButton.style.textAlign = 'center';
                showProjectButton.style.width = 'fit-content';
                showProjectButton.style.transition = 'background 0.3s';

                // Button hover effect
                showProjectButton.addEventListener('mouseover', () => {
                    showProjectButton.style.background = '#0056b3';
                });
                showProjectButton.addEventListener('mouseout', () => {
                    showProjectButton.style.background = '#007BFF';
                });

                result.push(showProjectButton);
            });

            return result;
        }

        function populateEducation(data) {
            const educationList = document.getElementById('education-list');
            if (Array.isArray(data.education)) {
                data.education.forEach(item => {
                    const li = document.createElement('li');
                    li.textContent = `${item.school || 'Institution not provided'}, ${item.degree || 'Field of study not provided'} (${item.startYear || ''} - ${item.endYear || 'Present'})`;
                    educationList.appendChild(li);
                });
            } else {
                educationList.innerHTML = '<li>No education data available</li>';
            }
        }

        function downloadPDF() {
            const container = document.querySelector('.container');

            // Clone the container to exclude the button from the PDF
            const clonedContainer = container.cloneNode(true);

            console.log(clonedContainer);
            const pdfButton = clonedContainer.querySelector('#pdf-btn'); // If your button has an ID

            console.log(pdfButton);

            if (pdfButton) {
                pdfButton.remove(); // Remove the PDF button from the cloned content
            }

            // Use html2pdf.js to convert the cloned content to a PDF
            html2pdf()
                .from(container)
                .save('resume.pdf'); // Save as resume.pdf
        }

        // Function to parse and compare dates
        function sortByField(data, field, order = 'desc') {
            return data.sort((a, b) => {
                // Extract the date components (e.g., "MM-YYYY")
                const [monthA, yearA] = a[field].split('-');
                const [monthB, yearB] = b[field].split('-');

                // Create Date objects from the extracted month and year
                const dateA = new Date(yearA, monthA - 1);  // monthA - 1 because months are 0-indexed
                const dateB = new Date(yearB, monthB - 1);  // monthB - 1 for the same reason

                // Return based on the order: ascending or descending
                if (order === 'asc') {
                    return dateA - dateB; // ascending order
                } else {
                    return dateB - dateA; // descending order
                }
            });
        }

        loadResumeData();
    </script>
</body>
</html>
